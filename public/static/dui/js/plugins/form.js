!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i(require("jquery")):"function"==typeof define&&define.amd?define("form",["jquery"],i):(e=e||self).form=i(e.jQuery)}(this,function(C){"use strict";C=C&&C.hasOwnProperty("default")?C.default:C;function o(e,i,t){return new o.Item[i](e,t)}function e(n,e){var o=this,i={name:String,disabled:{type:[Boolean,String],default:!1},label:String,value:String,bordered:Boolean,indeterminate:Boolean,buttoned:Boolean,checked:{type:[Boolean,String],default:!1},state:{type:[Boolean,String],default:!1},items:String};dui.setData(n,"checkbox",{},e),dui.setProps(n,"checkbox",i),o.el=n;var l=o.config=C.extend(!0,{},n.vnode.props.checkbox),t=o.template=['<div class="dui-checkbox'+(l.buttoned?"-button":"")+(l.checked?" is-checked":"")+(l.disabled?" is-disabled":"")+(l.bordered?" is-bordered":"")+'">',l.buttoned?"":'<span class="dui-checkbox__input'+(l.checked?" is-checked":"")+(l.disabled?" is-disabled":"")+'">','<span class="dui-checkbox'+(l.buttoned?"-button":"")+'__inner">'+(l.buttoned?l.label:"")+"</span>",l.buttoned?"":"</span>",l.buttoned?"":l.label?'<span class="dui-checkbox__label">'+l.label+"</span>":"","</div>"].join(""),s=o.$showDom=C(t),a=(C(n).parents(p.form),p.checkbox,l.items,"."+S.checkbox+(l.buttoned?"-button":"")+"__inner"),c=C(n).prev(a);l.indeterminate&&C(n).removeAttr("name"),c[0]&&c.parents("."+S.checkbox).after(n)&&c.parents("."+S.checkbox).remove(),C(n).after(s)&&s.find(a).after(n),n.checked=!(!l.checked||!0===l.indeterminate),l.disabled||s.off("click").on("click",function(e){var i=s,t=C(n),a=t.prop("checked");l.indeterminate&&(a=!i.find("."+S.checkboxInput).hasClass("is-indeterminate")&&!!i.hasClass("is-checked")),o.setChecked(!a),t[0]&&t.change&&t.change(),n.vnode.event.checkbox&&n.vnode.event.checkbox.change&&n.vnode.event.checkbox.change.call(n,t.prop("checked"))})}function i(e,i){var a=this,t=a.elements={},n={name:String,multiple:{type:[Boolean,String],default:!1},disabled:{type:[Boolean,String],default:!1},size:String,clearable:Boolean,placeholder:String,filterable:Boolean,original:Boolean};function o(){t.clickDom.removeClass("is-focuse"),g.removeClass("is-reverse"),a.isShow=!1,a.transition.hide()}a.state={inited:!1},dui.setData(e,"checkbox",i),dui.setProps(e,"checkbox",n);var l,s=a.config=C.extend(!0,{},e.vnode.props.checkbox),c=C(e).next("."+S.select),d=a.value=s.multiple?[]:"",r=a.optData=function a(e){var n=[];return C(e).children().each(function(e,i){var t={};"optgroup"===i.tagName.toLowerCase()?(t.label=C(i).attr("label"),t.type="group",0<i.children.length&&(t.childrens=a(i))):"option"===i.tagName.toLowerCase()&&(t.type="item",t.label=C(i).text(),t.value=C(i).val(),t.selected=void 0!==C(i).attr("selected"),t.disabled=void 0!==C(i).attr("disabled")),n.push(t)}),n}(e),u=a.tags=(l={},C(e).find("option").each(function(e,i){var t=C(i).text(),a=C(i).val(),n=C('<span class="dui-tag dui-tag--info dui-tag--small dui-tag--light"><span class="dui-select__tags-text">'+t+'</span><i class="dui-tag__close dui-icon-close"></i></span>')[0];n.value=a,l[a]=n}),l),p=a.optHtml=['<div class="dui-select-dropdown dui-popper'+(s.multiple?" is-multiple":"")+'" style="display:none">','<ul class="dui-select-dropdown__list">'+function t(e){var a="";return C.each(e,function(e,i){"group"==i.type?a+='<ul class="dui-select-group__wrap"><li class="dui-select-group__title">'+i.label+"</li><li>"+function(){if(i.childrens)return'<ul class="dui-select-group">'+t(i.childrens)+"</ul>"}()+"</li></ul>":"item"==i.type&&(a+='<li class="dui-select-dropdown__item'+(i.disabled?" is-disabled":"")+(i.selected?" selected":"")+'" dui-value="'+i.value+'"><span>'+i.label+"</span></li>")}),a}(r)+"</ul>",'<div x-arrow="" class="popper__arrow"></div>',"</div>"].join(" "),h=['<div class="'+S.select+(s.size?" "+S.select+"--"+s.size:"")+'">',s.multiple?'<div class="dui-select__tags"><span></span></div>':"",'<div class="dui-input'+(s.size?" dui-input--"+s.size:"")+" dui-input--suffix"+(s.disabled?" is-disabled":"")+'">','<input class="dui-input__inner dui-input--suffix"'+(s.filterable?"":' readonly="readonly"')+' placeholder="'+s.placeholder+'"'+(s.disabled?'disabled="disabled"':"")+">",'<span class="dui-input__suffix">','<span class="dui-input__suffix-inner">','<i class="dui-select__caret dui-input__icon dui-icon-arrow-up"></i>',s.clearable?'<i class="dui-select__caret dui-input__icon '+S.selectClearable+'" style="display:none"></i>':"","</span>","</span>","</div>","</div>"].join(""),f=t.original=C(e),v=t.emptyDom=C(['<p class="dui-select-dropdown__empty">无匹配数据</p>'].join("")),b=t.clickDom=C(h),m=(t.input=t.clickDom.find(".dui-input"),t.inputInner=t.clickDom.find(".dui-input__inner")),g=t.caret=t.clickDom.find(".dui-select__caret"),k=t.optDom=C(p),_=t.opts=k.find("."+S.selectOption);a.scrollbar=dui.addScrollBar(k.find(".dui-select-dropdown__list")[0],{wrapClass:"dui-select-dropdown__wrap"}),c[0]&&c.remove(),C(e).css("display","none").after(b),b.append(k),k.css("min-width",m.outerWidth());var w=b[0],x=k[0],y={top:"bottom",bottom:"top"};a.popper=dui.addPopper(w,x,{arrowOffset:35,onCreate:function(e){a.transition=dui.transition(x,{name:"dui-zoom-in-"+y[e._options.placement]})},onUpdate:function(e){a.transition.data.name="dui-zoom-in-"+y[e.placement],k.css("min-width",b.outerWidth())}}),s.multiple?f.find("option[selected]").each(function(e,i){var t=C(i).val();-1==C.inArray(t,d)&&a.value.push(t)}):f.find("option[selected]").each(function(e,i){a.value=C(i).val()}),a.setValue(),s.disabled||(dui.on(b[0],"click",function(e){e.stopPropagation(),a.isShow?o():(C("body").append(x),t.input.addClass("is-focuse"),g.addClass("is-reverse"),k.css("min-width",b.outerWidth()),a.popper.updatePopper(),a.isShow=!0,a.transition.show())}),_.on("click",function(e){var i=C(this),t=i.attr("dui-value");s.multiple?i.hasClass("selected")?a.value.splice(C.inArray(t,d),1):-1==C.inArray(t,d)&&a.value.push(t):(a.value=t,o()),a.setValue()}),C.each(u,function(i,e){dui.on(e.children[1],"click",function(e){e.stopPropagation(),a.value.splice(C.inArray(i,a.value),1),a.setValue()})}),s.clearable&&(b.hover(function(){0<a.value.length&&(b.find(".dui-icon-arrow-up").css("display","none"),b.find("."+S.selectClearable).css("display",""))},function(e){b.find(".dui-icon-arrow-up").css("display",""),b.find("."+S.selectClearable).css("display","none")}),b.find("."+S.selectClearable).on("click",function(e){e.stopPropagation(),d=a.value=s.multiple?[]:"",a.setValue()})),s.filterable&&m.on("input",function(e){var n=this.value,i=e.keyCode;if(9===i||13===i||37===i||38===i||39===i||40===i)return!1;_.each(function(e,i){var t=C(i),a=t.text();t[-1===a.indexOf(n)?"addClass":"removeClass"](S.hide)}),C(k).find(".dui-select-group__wrap").each(function(e,i){var t=C(i);t.find("."+S.selectOption+"."+S.hide).length==t.find("."+S.selectOption).length?t.addClass(S.hide):t.removeClass(S.hide)}),k.find("."+S.selectOption+"."+S.hide).length==_.length?(C(a.scrollbar.scroll).addClass("is-empty"),C(a.scrollbar.scroll).after(v)):(C(a.scrollbar.scroll).removeClass("is-empty"),v.remove())}),dui.on(document,"click",function(e){var i=C(e.target);if(t.optDom.find(i)[0]||t.optDom[0]==i[0])return!1;o()}))}var p={form:"[dui-form]",switch:'input[type="checkbox"][dui-switch]',checkbox:'input[type="checkbox"][dui-checkbox]',radio:'input[type="radio"][dui-radio]',select:"select[dui-select]"},S={switch:"dui-switch",switchLabelLeft:"dui-switch__label--left",switchLabelRight:"dui-switch__label--right",checkbox:"dui-checkbox",checkboxInput:"dui-checkbox__input",radio:"dui-radio",radioInput:"dui-radio__input",radioGroup:"dui-radio-group",select:"dui-select",selectOption:"dui-select-dropdown__item",selectClearable:"dui-icon-circle-close",hide:"dui-hide"};return o.Item=o.prototype={init:function(a,e,i){(this.el=a).vnode&&delete a.vnode,dui.setData(a,"form",{rule:!1},e);return C(a).off("submit").on("submit",function(e){var i=a.vnode.data.form,t=a.vnode.event.form;return t.submit&&"function"==typeof t.submit&&t.submit.call(a,e),i.rule,!0}),i||o.render(a),this},switch:function(a,e){var n=this,o={name:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},value:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},activeText:String,inactiveText:String,clearable:{type:Boolean,default:!1},width:{type:Number,default:40}};n.el=a,n.originalValue||(n.originalValue=a.value),dui.setData(a,"switch",{},e),dui.setProps(a,"switch",o);var l=n.config=C.extend(!0,{},a.vnode.props.switch);n.template=['<div class="dui-switch'+(l.activeValue==l.value?" is-checked":"")+'">',n.config.inactiveText?'<span class="dui-switch__label dui-switch__label--left'+(l.inactiveValue==l.value?" is-active":"")+'"><span>'+l.inactiveText+"</span></span>":"",'<span class="dui-switch__core" style="width: '+l.width+'px;"></span>',n.config.activeText?'<span class="dui-switch__label dui-switch__label--right'+(l.activeValue==l.value?" is-active":"")+'"><span>'+l.activeText+"</span></span>":"","</div>"].join(""),C(a).prop("checked",!0);var s=n.$showDom=C(n.template),i=C(a).next("."+S.switch);return i[0]&&(a.value=n.originalValue)&&i.remove(),C(a).after(s),s.off("click").on("click",function(e){if(!l.disabled){var i=C(n.el),t=i.val();dui.convertProp(t,o.value.type)==n.config.activeValue?(i.val(n.config.inactiveValue),s.removeClass("is-checked"),s.find("."+S.switchLabelLeft).addClass("is-active"),s.find("."+S.switchLabelRight).removeClass("is-active")):(i.val(n.config.activeValue),s.addClass("is-checked"),s.find("."+S.switchLabelLeft).removeClass("is-active"),s.find("."+S.switchLabelRight).addClass("is-active")),i[0]&&i.change&&i.change(),a.vnode.event.switch&&a.vnode.event.switch.change&&a.vnode.event.switch.change.call(a,i.val())}}),n},checkbox:e,radio:function(t,e){var i=this,a={name:String,value:{type:[Boolean,Number,String],default:""},label:{type:[Boolean,Number,String],default:""},bordered:Boolean,disabled:{type:[Boolean,String],default:!1},buttoned:Boolean,checked:{type:[Boolean,String],default:!1}};dui.setData(t,"checkbox",{},e),dui.setProps(t,"checkbox",a);var n=i.config=C.extend(!0,{},t.vnode.props.checkbox),o=0<C(t).parents("."+S.radioGroup).length?C(t).parents("."+S.radioGroup):C(t).parents(p.form),l=n.buttoned?"is-active":"is-checked",s=1==o.find(p.radio+'[name="'+n.name+'"][checked]').length&&n.checked?" "+l:(C(t).prop("checked",!1),C(t).removeAttr("checked"),""),c=i.template=['<div class="dui-radio'+(n.buttoned?"-button":"")+(n.bordered?" is-bordered":"")+(s?" "+l:"")+(n.disabled?" is-disabled":"")+'">',n.buttoned?"":'<span class="dui-radio__input'+(s?" is-checked":"")+(n.disabled?" is-disabled":"")+'">','<span class="dui-radio'+(n.buttoned?"-button":"")+'__inner">'+(n.buttoned?n.label:"")+"</span>",n.buttoned?"":"</span>",n.buttoned?"":'<span class="dui-radio__label">'+n.label+"</span>","</div>"].join(""),d=i.$showDom=C(c),r="."+S.radio+(n.buttoned?"-button":"")+"__inner",u=C(t).prev(r);u[0]&&u.parents("."+S.radio).after(t)&&u.parents("."+S.radio).remove(),C(t).after(d)&&d.find(r).after(t),d.on("click",function(e){if(!n.disabled){var i=C(t);!1===i.prop("checked")&&(o.find(p.radio+'[name="'+n.name+'"]').prop("checked",!1),i.prop("checked",!0),o.find(p.radio+'[name="'+n.name+'"]').parents("."+S.radio+(n.buttoned?"-button":"")).removeClass(l),"is-checked"==l&&o.find(p.radio+'[name="'+n.name+'"]').parents("."+S.radioInput).removeClass(l),d.addClass(l),"is-checked"==l&&i.parents("."+S.radioInput).addClass(l),i[0]&&i.change&&i.change(),t.vnode.event.radio&&t.vnode.event.radio.change&&t.vnode.event.radio.change.call(t,i.prop("checked")))}})},select:i},o.render=function(e,i,t,a){t=t?'[dui-filter="'+t+'"]':"";var n={switch:function(){C(e).find(p.switch+t).each(function(e,i){i.switchClass=new o.Item.switch(i,a)})},checkbox:function(){C(e).find(p.checkbox).each(function(e,i){i.checkboxClass=new o.Item.checkbox(i,a)})},radio:function(){C(e).find(p.radio).each(function(e,i){i.radioClass=new o.Item.radio(i,a)})},select:function(){C(e).find(p.select).each(function(e,i){i.selectClass=new o.Item.select(i,a)})}};e.vnode&&new o.Item.init(e,{},!0),i?n[i]&&n[i]():C.each(n,function(e,i){i()})},o.init=function(e,t){e=e?'[dui-filter="'+e+'"]':"";var i=C(p.form+e),a=[];return i.each(function(e,i){a.push(new o.Item.init(i,t))}),1<a.length?a:a[0]},i.prototype.setValue=function(e){var t=this,i=t.config,a=t.elements,n=a.optDom.find("."+S.selectOption),o=a.clickDom.find(".dui-select__tags>span");if(e&&(t.value=e),0==t.value.length?(a.inputInner.val(""),a.original.val(null),i.multiple&&a.inputInner.attr("placeholder",i.placeholder)):(a.original.val(t.value),i.multiple&&a.inputInner.attr("placeholder","")),o.html(""),n.removeClass("selected"),i.multiple){C.each(t.value,function(e,i){a.optDom.find("."+S.selectOption+'[dui-value="'+i+'"]').addClass("selected"),o.append(t.tags[i])});var l=parseFloat(o.parent().outerHeight()),s=parseFloat(a.inputInner.outerHeight());s<l||36<s?a.inputInner.css("height",parseFloat(l)+6):a.inputInner.css("height","")}else{var c=a.optDom.find("."+S.selectOption+'[dui-value="'+t.value+'"]');c.addClass("selected"),a.inputInner.val(c.text())}if(t.popper.updatePopper(),t.state.inited){var d=a.original[0].vnode.event;a.original.change&&a.original.change(),d.select&&d.select.change&&"function"==typeof d.select.change&&d.select.change.call(a.original,t.value)}else t.state.inited=!0},e.prototype.setChecked=function(e){var i=this.config,t=this.el,a=C(t),n=a.parents(".dui-checkbox"),o="is-checked";"indeterminate"===e&&i.indeterminate?(a.prop("checked",!1),n.find("."+S.checkboxInput).removeClass("is-checked").addClass("is-indeterminate"),n.removeClass("is-checked"),i.buttoned||n.find("."+S.checkboxInput).removeClass("is-checked")):(!0===e?(i.indeterminate?a.prop("checked",!1):a.prop("checked",!0),n.addClass(o),i.buttoned||n.find("."+S.checkboxInput).addClass(o)):(a.prop("checked",!1),n.removeClass(o),i.buttoned||n.find("."+S.checkboxInput).removeClass(o)),i.indeterminate&&n.find("."+S.checkboxInput).removeClass("is-indeterminate"))},o.init(),o});