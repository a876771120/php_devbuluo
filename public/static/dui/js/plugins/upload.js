!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define("upload",["jquery"],t):(e=e||self).upload=t(e.jQuery)}(this,function(r){"use strict";function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r=r&&r.hasOwnProperty("default")?r.default:r;var e;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;return function(e,t){e.exports=function(u){function e(e,t){return e(t={exports:{}},t.exports),t.exports}u=u&&u.hasOwnProperty("default")?u.default:u;var s=e(function(e){e.exports=function n(e){if(!(this instanceof n))return new n(e);if(this.version=1,this.support=!("undefined"==typeof File||"undefined"==typeof Blob||"undefined"==typeof FileList||!Blob.prototype.webkitSlice&&!Blob.prototype.mozSlice&&!Blob.prototype.slice),!this.support)return!1;var h=this;h.files=[],h.defaults={chunkSize:1048576,forceChunkSize:!1,simultaneousUploads:3,fileParameterName:"file",chunkNumberParameterName:"resumableChunkNumber",chunkSizeParameterName:"resumableChunkSize",currentChunkSizeParameterName:"resumableCurrentChunkSize",totalSizeParameterName:"resumableTotalSize",typeParameterName:"resumableType",identifierParameterName:"resumableIdentifier",fileNameParameterName:"resumableFilename",relativePathParameterName:"resumableRelativePath",totalChunksParameterName:"resumableTotalChunks",throttleProgressCallbacks:.5,query:{},headers:{},preprocess:null,method:"multipart",uploadMethod:"POST",testMethod:"GET",prioritizeFirstAndLastChunk:!1,target:"/",testTarget:null,parameterNamespace:"",testChunks:!0,generateUniqueIdentifier:null,getTarget:null,maxChunkRetries:100,chunkRetryInterval:void 0,permanentErrors:[400,404,415,500,501],maxFiles:void 0,withCredentials:!1,xhrTimeout:0,clearInput:!0,chunkFormat:"blob",setChunkTypeFromFile:!1,maxFilesErrorCallback:function(e,t){var r=h.getOpt("maxFiles");alert("Please upload no more than "+r+" file"+(1===r?"":"s")+" at a time.")},minFileSize:1,minFileSizeErrorCallback:function(e,t){alert(e.fileName||e.name+" is too small, please upload files larger than "+d.formatSize(h.getOpt("minFileSize"))+".")},maxFileSize:void 0,maxFileSizeErrorCallback:function(e,t){alert(e.fileName||e.name+" is too large, please upload files less than "+d.formatSize(h.getOpt("maxFileSize"))+".")},fileType:[],fileTypeErrorCallback:function(e,t){alert(e.fileName||e.name+" has type not allowed, please upload files of type "+h.getOpt("fileType")+".")}},h.opts=e||{},h.getOpt=function(e){var t=this;if(e instanceof Array){var r={};return d.each(e,function(e){r[e]=t.getOpt(e)}),r}if(t instanceof o){if(void 0!==t.opts[e])return t.opts[e];t=t.fileObj}if(t instanceof m){if(void 0!==t.opts[e])return t.opts[e];t=t.resumableObj}if(t instanceof n)return void 0!==t.opts[e]?t.opts[e]:t.defaults[e]},h.events=[],h.on=function(e,t){h.events.push(e.toLowerCase(),t)},h.fire=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);for(var r=e[0].toLowerCase(),t=0;t<=h.events.length;t+=2)h.events[t]==r&&h.events[t+1].apply(h,e.slice(1)),"catchall"==h.events[t]&&h.events[t+1].apply(null,e);"fileerror"==r&&h.fire("error",e[2],e[1]),"fileprogress"==r&&h.fire("progress")};var d={stopEvent:function(e){e.stopPropagation(),e.preventDefault()},each:function(e,t){if(void 0!==e.length){for(var r=0;r<e.length;r++)if(!1===t(e[r]))return}else for(r in e)if(!1===t(r,e[r]))return},generateUniqueIdentifier:function(e,t){var r=h.getOpt("generateUniqueIdentifier");if("function"==typeof r)return r(e,t);var n=e.webkitRelativePath||e.fileName||e.name,i=e.size;return i+"-"+n.replace(/[^0-9a-zA-Z_-]/gim,"")},contains:function(e,t){var r=!1;return d.each(e,function(e){return e!=t||!(r=!0)}),r},formatSize:function(e){return e<1024?e+" bytes":e<1048576?(e/1024).toFixed(0)+" KB":e<1073741824?(e/1024/1024).toFixed(1)+" MB":(e/1024/1024/1024).toFixed(1)+" GB"},getTarget:function(e,t){var r=h.getOpt("target");if("test"===e&&h.getOpt("testTarget")&&(r="/"===h.getOpt("testTarget")?h.getOpt("target"):h.getOpt("testTarget")),"function"==typeof r)return r(t);var n=r.indexOf("?")<0?"?":"&",i=t.join("&");return r+n+i}},t=function(e){d.stopEvent(e),e.dataTransfer&&e.dataTransfer.items?i(e.dataTransfer.items,e):e.dataTransfer&&e.dataTransfer.files&&i(e.dataTransfer.files,e)},r=function(e){e.preventDefault()};function l(e,t,r,n){var i,a,o,s,u;return e.isFile?e.file(function(e){e.relativePath=t+e.name,r.push(e),n()}):(e.isDirectory?i=e:e instanceof File&&r.push(e),"function"==typeof e.webkitGetAsEntry&&(i=e.webkitGetAsEntry()),i&&i.isDirectory?(o=t+(a=i).name+"/",s=r,u=n,void a.createReader().readEntries(function(e){if(!e.length)return u();f(e.map(function(e){return l.bind(null,e,o,s)}),u)})):("function"==typeof e.getAsFile&&(e=e.getAsFile())instanceof File&&(e.relativePath=t+e.name,r.push(e)),void n()))}function f(e,t){if(!e||0===e.length)return t();e[0](function(){f(e.slice(1),t)})}function i(e,t){if(e.length){h.fire("beforeAdd");var r=[];f(Array.prototype.map.call(e,function(e){return l.bind(null,e,"",r)}),function(){r.length&&a(r,t)})}}var a=function(e,s){var u=0,l=h.getOpt(["maxFiles","minFileSize","maxFileSize","maxFilesErrorCallback","minFileSizeErrorCallback","maxFileSizeErrorCallback","fileType","fileTypeErrorCallback"]);if(void 0!==l.maxFiles&&l.maxFiles<e.length+h.files.length){if(1!==l.maxFiles||1!==h.files.length||1!==e.length)return l.maxFilesErrorCallback(e,u++),!1;h.removeFile(h.files[0])}var f=[],c=[],t=e.length,p=function(){if(!--t){if(!f.length&&!c.length)return;window.setTimeout(function(){h.fire("filesAdded",f,c)},0)}};d.each(e,function(r){var e=r.name;if(0<l.fileType.length){var t=!1;for(var n in l.fileType){var i="."+l.fileType[n];if(-1!==e.toLowerCase().indexOf(i.toLowerCase(),e.length-i.length)){t=!0;break}}if(!t)return l.fileTypeErrorCallback(r,u++),!1}if(void 0!==l.minFileSize&&r.size<l.minFileSize)return l.minFileSizeErrorCallback(r,u++),!1;if(void 0!==l.maxFileSize&&r.size>l.maxFileSize)return l.maxFileSizeErrorCallback(r,u++),!1;function a(t){h.getFromUniqueIdentifier(t)?c.push(r):function(){r.uniqueIdentifier=t;var e=new m(h,r,t);h.files.push(e),f.push(e),e.container=void 0!==s?s.srcElement:null,window.setTimeout(function(){h.fire("fileAdded",e,s)},0)}(),p()}var o=d.generateUniqueIdentifier(r,s);o&&"function"==typeof o.then?o.then(function(e){a(e)},function(){p()}):a(o)})};function m(e,t,r){var n=this;n.opts={},n.getOpt=e.getOpt,n._prevProgress=0,n.resumableObj=e,n.file=t,n.fileName=t.fileName||t.name,n.size=t.size,n.relativePath=t.relativePath||t.webkitRelativePath||n.fileName,n.uniqueIdentifier=r,n._pause=!1,n.container="";var i=void 0!==r,a=function(e,t){switch(e){case"progress":n.resumableObj.fire("fileProgress",n,t);break;case"error":n.abort(),i=!0,n.chunks=[],n.resumableObj.fire("fileError",n,t);break;case"success":if(i)return;n.resumableObj.fire("fileProgress",n),n.isComplete()&&n.resumableObj.fire("fileSuccess",n,t);break;case"retry":n.resumableObj.fire("fileRetry",n)}};return n.chunks=[],n.abort=function(){var t=0;d.each(n.chunks,function(e){"uploading"==e.status()&&(e.abort(),t++)}),0<t&&n.resumableObj.fire("fileProgress",n)},n.cancel=function(){var e=n.chunks;n.chunks=[],d.each(e,function(e){"uploading"==e.status()&&(e.abort(),n.resumableObj.uploadNextChunk())}),n.resumableObj.removeFile(n),n.resumableObj.fire("fileProgress",n)},n.retry=function(){n.bootstrap();var e=!1;n.resumableObj.on("chunkingComplete",function(){e||n.resumableObj.upload(),e=!0})},n.bootstrap=function(){n.abort(),i=!1,n.chunks=[],n._prevProgress=0;for(var e=n.getOpt("forceChunkSize")?Math.ceil:Math.floor,t=Math.max(e(n.file.size/n.getOpt("chunkSize")),1),r=0;r<t;r++)!function(e){window.setTimeout(function(){n.chunks.push(new o(n.resumableObj,n,e,a)),n.resumableObj.fire("chunkingProgress",n,e/t)},0)}(r);window.setTimeout(function(){n.resumableObj.fire("chunkingComplete",n)},0)},n.progress=function(){if(i)return 1;var t=0,r=!1;return d.each(n.chunks,function(e){"error"==e.status()&&(r=!0),t+=e.progress(!0)}),t=r?1:.99999<t?1:t,t=Math.max(n._prevProgress,t),n._prevProgress=t},n.isUploading=function(){var t=!1;return d.each(n.chunks,function(e){if("uploading"==e.status())return!(t=!0)}),t},n.isComplete=function(){var r=!1;return d.each(n.chunks,function(e){var t=e.status();if("pending"==t||"uploading"==t||1===e.preprocessState)return!(r=!0)}),!r},n.pause=function(e){n._pause=void 0===e?!n._pause:e},n.isPaused=function(){return n._pause},n.resumableObj.fire("chunkingStart",n),n.bootstrap(),this}function o(e,t,r,n){var h=this;h.opts={},h.getOpt=e.getOpt,h.resumableObj=e,h.fileObj=t,h.fileObjSize=t.size,h.fileObjType=t.file.type,h.offset=r,h.callback=n,h.lastProgressCallback=new Date,h.tested=!1,h.retries=0,h.pendingRetry=!1,h.preprocessState=0;var i=h.getOpt("chunkSize");return h.loaded=0,h.startByte=h.offset*i,h.endByte=Math.min(h.fileObjSize,(h.offset+1)*i),h.fileObjSize-h.endByte<i&&!h.getOpt("forceChunkSize")&&(h.endByte=h.fileObjSize),h.xhr=null,h.test=function(){h.xhr=new XMLHttpRequest;var e=function(e){h.tested=!0;var t=h.status();"success"==t?(h.callback(t,h.message()),h.resumableObj.uploadNextChunk()):h.send()};h.xhr.addEventListener("load",e,!1),h.xhr.addEventListener("error",e,!1),h.xhr.addEventListener("timeout",e,!1);var r=[],n=h.getOpt("parameterNamespace"),t=h.getOpt("query");"function"==typeof t&&(t=t(h.fileObj,h)),d.each(t,function(e,t){r.push([encodeURIComponent(n+e),encodeURIComponent(t)].join("="))}),r=r.concat([["chunkNumberParameterName",h.offset+1],["chunkSizeParameterName",h.getOpt("chunkSize")],["currentChunkSizeParameterName",h.endByte-h.startByte],["totalSizeParameterName",h.fileObjSize],["typeParameterName",h.fileObjType],["identifierParameterName",h.fileObj.uniqueIdentifier],["fileNameParameterName",h.fileObj.fileName],["relativePathParameterName",h.fileObj.relativePath],["totalChunksParameterName",h.fileObj.chunks.length]].filter(function(e){return h.getOpt(e[0])}).map(function(e){return[n+h.getOpt(e[0]),encodeURIComponent(e[1])].join("=")})),h.xhr.open(h.getOpt("testMethod"),d.getTarget("test",r)),h.xhr.timeout=h.getOpt("xhrTimeout"),h.xhr.withCredentials=h.getOpt("withCredentials");var i=h.getOpt("headers");"function"==typeof i&&(i=i(h.fileObj,h)),d.each(i,function(e,t){h.xhr.setRequestHeader(e,t)}),h.xhr.send(null)},h.preprocessFinished=function(){h.preprocessState=2,h.send()},h.send=function(){var e=h.getOpt("preprocess");if("function"==typeof e)switch(h.preprocessState){case 0:return h.preprocessState=1,void e(h);case 1:return}if(!h.getOpt("testChunks")||h.tested){h.xhr=new XMLHttpRequest,h.xhr.upload.addEventListener("progress",function(e){new Date-h.lastProgressCallback>1e3*h.getOpt("throttleProgressCallbacks")&&(h.callback("progress"),h.lastProgressCallback=new Date),h.loaded=e.loaded||0},!1),h.loaded=0,h.pendingRetry=!1,h.callback("progress");var t=function(e){var t=h.status();if("success"==t||"error"==t)h.callback(t,h.message()),h.resumableObj.uploadNextChunk();else{h.callback("retry",h.message()),h.abort(),h.retries++;var r=h.getOpt("chunkRetryInterval");void 0!==r?(h.pendingRetry=!0,setTimeout(h.send,r)):h.send()}};h.xhr.addEventListener("load",t,!1),h.xhr.addEventListener("error",t,!1),h.xhr.addEventListener("timeout",t,!1);var r=[["chunkNumberParameterName",h.offset+1],["chunkSizeParameterName",h.getOpt("chunkSize")],["currentChunkSizeParameterName",h.endByte-h.startByte],["totalSizeParameterName",h.fileObjSize],["typeParameterName",h.fileObjType],["identifierParameterName",h.fileObj.uniqueIdentifier],["fileNameParameterName",h.fileObj.fileName],["relativePathParameterName",h.fileObj.relativePath],["totalChunksParameterName",h.fileObj.chunks.length]].filter(function(e){return h.getOpt(e[0])}).reduce(function(e,t){return e[h.getOpt(t[0])]=t[1],e},{}),n=h.getOpt("query");"function"==typeof n&&(n=n(h.fileObj,h)),d.each(n,function(e,t){r[e]=t});var i=h.fileObj.file.slice?"slice":h.fileObj.file.mozSlice?"mozSlice":h.fileObj.file.webkitSlice?"webkitSlice":"slice",a=h.fileObj.file[i](h.startByte,h.endByte,h.getOpt("setChunkTypeFromFile")?h.fileObj.file.type:""),o=null,s=[],u=h.getOpt("parameterNamespace");if("octet"===h.getOpt("method"))o=a,d.each(r,function(e,t){s.push([encodeURIComponent(u+e),encodeURIComponent(t)].join("="))});else if(o=new FormData,d.each(r,function(e,t){o.append(u+e,t),s.push([encodeURIComponent(u+e),encodeURIComponent(t)].join("="))}),"blob"==h.getOpt("chunkFormat"))o.append(u+h.getOpt("fileParameterName"),a,h.fileObj.fileName);else if("base64"==h.getOpt("chunkFormat")){var l=new FileReader;l.onload=function(e){o.append(u+h.getOpt("fileParameterName"),l.result),h.xhr.send(o)},l.readAsDataURL(a)}var f=d.getTarget("upload",s),c=h.getOpt("uploadMethod");h.xhr.open(c,f),"octet"===h.getOpt("method")&&h.xhr.setRequestHeader("Content-Type","application/octet-stream"),h.xhr.timeout=h.getOpt("xhrTimeout"),h.xhr.withCredentials=h.getOpt("withCredentials");var p=h.getOpt("headers");"function"==typeof p&&(p=p(h.fileObj,h)),d.each(p,function(e,t){h.xhr.setRequestHeader(e,t)}),"blob"==h.getOpt("chunkFormat")&&h.xhr.send(o)}else h.test()},h.abort=function(){h.xhr&&h.xhr.abort(),h.xhr=null},h.status=function(){return h.pendingRetry?"uploading":h.xhr?h.xhr.readyState<4?"uploading":200==h.xhr.status||201==h.xhr.status?"success":d.contains(h.getOpt("permanentErrors"),h.xhr.status)||h.retries>=h.getOpt("maxChunkRetries")?"error":(h.abort(),"pending"):"pending"},h.message=function(){return h.xhr?h.xhr.responseText:""},h.progress=function(e){void 0===e&&(e=!1);var t=e?(h.endByte-h.startByte)/h.fileObjSize:1;if(h.pendingRetry)return 0;h.xhr&&h.xhr.status||(t*=.95);var r=h.status();switch(r){case"success":case"error":return 1*t;case"pending":return 0*t;default:return h.loaded/(h.endByte-h.startByte)*t}},this}return h.uploadNextChunk=function(){var t=!1;if(h.getOpt("prioritizeFirstAndLastChunk")&&(d.each(h.files,function(e){return e.chunks.length&&"pending"==e.chunks[0].status()&&0===e.chunks[0].preprocessState?(e.chunks[0].send(),!(t=!0)):1<e.chunks.length&&"pending"==e.chunks[e.chunks.length-1].status()&&0===e.chunks[e.chunks.length-1].preprocessState?(e.chunks[e.chunks.length-1].send(),!(t=!0)):void 0}),t))return!0;if(d.each(h.files,function(e){if(!1===e.isPaused()&&d.each(e.chunks,function(e){if("pending"==e.status()&&0===e.preprocessState)return e.send(),!(t=!0)}),t)return!1}),t)return!0;var r=!1;return d.each(h.files,function(e){if(!e.isComplete())return!(r=!0)}),r||h.fire("complete"),!1},h.assignBrowse=function(e,i){void 0===e.length&&(e=[e]),d.each(e,function(e){var t;"INPUT"===e.tagName&&"file"===e.type?t=e:((t=document.createElement("input")).setAttribute("type","file"),t.style.display="none",e.addEventListener("click",function(){t.style.opacity=0,t.style.display="block",t.focus(),t.click(),t.style.display="none"},!1),e.appendChild(t));var r=h.getOpt("maxFiles");void 0===r||1!=r?t.setAttribute("multiple","multiple"):t.removeAttribute("multiple"),i?t.setAttribute("webkitdirectory","webkitdirectory"):t.removeAttribute("webkitdirectory");var n=h.getOpt("fileType");void 0!==n&&1<=n.length?t.setAttribute("accept",n.map(function(e){return"."+e}).join(",")):t.removeAttribute("accept"),t.addEventListener("change",function(e){a(e.target.files,e),h.getOpt("clearInput")&&(e.target.value="")},!1)})},h.assignDrop=function(e){void 0===e.length&&(e=[e]),d.each(e,function(e){e.addEventListener("dragover",r,!1),e.addEventListener("dragenter",r,!1),e.addEventListener("drop",t,!1)})},h.unAssignDrop=function(e){void 0===e.length&&(e=[e]),d.each(e,function(e){e.removeEventListener("dragover",r),e.removeEventListener("dragenter",r),e.removeEventListener("drop",t)})},h.isUploading=function(){var t=!1;return d.each(h.files,function(e){if(e.isUploading())return!(t=!0)}),t},h.upload=function(){if(!h.isUploading()){h.fire("uploadStart");for(var e=1;e<=h.getOpt("simultaneousUploads");e++)h.uploadNextChunk()}},h.pause=function(){d.each(h.files,function(e){e.abort()}),h.fire("pause")},h.cancel=function(){h.fire("beforeCancel");for(var e=h.files.length-1;0<=e;e--)h.files[e].cancel();h.fire("cancel")},h.progress=function(){var t=0,r=0;return d.each(h.files,function(e){t+=e.progress()*e.size,r+=e.size}),0<r?t/r:0},h.addFile=function(e,t){a([e],t)},h.addFiles=function(e,t){a(e,t)},h.removeFile=function(e){for(var t=h.files.length-1;0<=t;t--)h.files[t]===e&&h.files.splice(t,1)},h.getFromUniqueIdentifier=function(t){var r=!1;return d.each(h.files,function(e){e.uniqueIdentifier==t&&(r=e)}),r},h.getSize=function(){var t=0;return d.each(h.files,function(e){t+=e.size}),t},h.handleDropEvent=function(e){t(e)},h.handleChangeEvent=function(e){a(e.target.files,e),e.target.value=""},h.updateQuery=function(e){h.opts.query=e},this}}),p=e(function(e,t){e.exports=function(f){var o=function(e,t){return e+t&4294967295},n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function s(e,t,r,n,i,a){return t=o(o(t,e),o(n,a)),o(t<<i|t>>>32-i,r)}function u(e,t,r,n,i,a,o){return s(t&r|~t&n,e,t,i,a,o)}function l(e,t,r,n,i,a,o){return s(t&n|r&~n,e,t,i,a,o)}function c(e,t,r,n,i,a,o){return s(t^r^n,e,t,i,a,o)}function p(e,t,r,n,i,a,o){return s(r^(t|~n),e,t,i,a,o)}function h(e,t){var r=e[0],n=e[1],i=e[2],a=e[3];r=u(r,n,i,a,t[0],7,-680876936),a=u(a,r,n,i,t[1],12,-389564586),i=u(i,a,r,n,t[2],17,606105819),n=u(n,i,a,r,t[3],22,-1044525330),r=u(r,n,i,a,t[4],7,-176418897),a=u(a,r,n,i,t[5],12,1200080426),i=u(i,a,r,n,t[6],17,-1473231341),n=u(n,i,a,r,t[7],22,-45705983),r=u(r,n,i,a,t[8],7,1770035416),a=u(a,r,n,i,t[9],12,-1958414417),i=u(i,a,r,n,t[10],17,-42063),n=u(n,i,a,r,t[11],22,-1990404162),r=u(r,n,i,a,t[12],7,1804603682),a=u(a,r,n,i,t[13],12,-40341101),i=u(i,a,r,n,t[14],17,-1502002290),n=u(n,i,a,r,t[15],22,1236535329),r=l(r,n,i,a,t[1],5,-165796510),a=l(a,r,n,i,t[6],9,-1069501632),i=l(i,a,r,n,t[11],14,643717713),n=l(n,i,a,r,t[0],20,-373897302),r=l(r,n,i,a,t[5],5,-701558691),a=l(a,r,n,i,t[10],9,38016083),i=l(i,a,r,n,t[15],14,-660478335),n=l(n,i,a,r,t[4],20,-405537848),r=l(r,n,i,a,t[9],5,568446438),a=l(a,r,n,i,t[14],9,-1019803690),i=l(i,a,r,n,t[3],14,-187363961),n=l(n,i,a,r,t[8],20,1163531501),r=l(r,n,i,a,t[13],5,-1444681467),a=l(a,r,n,i,t[2],9,-51403784),i=l(i,a,r,n,t[7],14,1735328473),n=l(n,i,a,r,t[12],20,-1926607734),r=c(r,n,i,a,t[5],4,-378558),a=c(a,r,n,i,t[8],11,-2022574463),i=c(i,a,r,n,t[11],16,1839030562),n=c(n,i,a,r,t[14],23,-35309556),r=c(r,n,i,a,t[1],4,-1530992060),a=c(a,r,n,i,t[4],11,1272893353),i=c(i,a,r,n,t[7],16,-155497632),n=c(n,i,a,r,t[10],23,-1094730640),r=c(r,n,i,a,t[13],4,681279174),a=c(a,r,n,i,t[0],11,-358537222),i=c(i,a,r,n,t[3],16,-722521979),n=c(n,i,a,r,t[6],23,76029189),r=c(r,n,i,a,t[9],4,-640364487),a=c(a,r,n,i,t[12],11,-421815835),i=c(i,a,r,n,t[15],16,530742520),n=c(n,i,a,r,t[2],23,-995338651),r=p(r,n,i,a,t[0],6,-198630844),a=p(a,r,n,i,t[7],10,1126891415),i=p(i,a,r,n,t[14],15,-1416354905),n=p(n,i,a,r,t[5],21,-57434055),r=p(r,n,i,a,t[12],6,1700485571),a=p(a,r,n,i,t[3],10,-1894986606),i=p(i,a,r,n,t[10],15,-1051523),n=p(n,i,a,r,t[1],21,-2054922799),r=p(r,n,i,a,t[8],6,1873313359),a=p(a,r,n,i,t[15],10,-30611744),i=p(i,a,r,n,t[6],15,-1560198380),n=p(n,i,a,r,t[13],21,1309151649),r=p(r,n,i,a,t[4],6,-145523070),a=p(a,r,n,i,t[11],10,-1120210379),i=p(i,a,r,n,t[2],15,718787259),n=p(n,i,a,r,t[9],21,-343485551),e[0]=o(r,e[0]),e[1]=o(n,e[1]),e[2]=o(i,e[2]),e[3]=o(a,e[3])}function d(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}function m(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return r}function i(e){var t,r,n,i,a,o,s=e.length,u=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=s;t+=64)h(u,d(e.substring(t-64,t)));for(e=e.substring(t-64),r=e.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<r;t+=1)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),55<t)for(h(u,n),t=0;t<16;t+=1)n[t]=0;return i=(i=8*s).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(i[2],16),o=parseInt(i[1],16)||0,n[14]=a,n[15]=o,h(u,n),u}function r(e){var t,r="";for(t=0;t<4;t+=1)r+=n[e>>8*t+4&15]+n[e>>8*t&15];return r}function g(e){var t;for(t=0;t<e.length;t+=1)e[t]=r(e[t]);return e.join("")}function a(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function b(e){var t,r=[],n=e.length;for(t=0;t<n-1;t+=2)r.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,r)}function v(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==g(i("hello"))&&(o=function(e,t){var r=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(r>>16);return n<<16|65535&r}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function l(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(e,t){var r,n,i,a,o=this.byteLength,s=l(e,o),u=o;return t!==f&&(u=l(t,o)),u<s?new ArrayBuffer(0):(r=u-s,n=new ArrayBuffer(r),i=new Uint8Array(n),a=new Uint8Array(this,s,r),i.set(a),n)}}(),v.prototype.append=function(e){return this.appendBinary(a(e)),this},v.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,r=this._buff.length;for(t=64;t<=r;t+=64)h(this._hash,d(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},v.prototype.end=function(e){var t,r,n=this._buff,i=n.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)a[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(a,i),r=g(this._hash),e&&(r=b(r)),this.reset(),r},v.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},v.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},v.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},v.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},v.prototype._finish=function(e,t){var r,n,i,a=t;if(e[a>>2]|=128<<(a%4<<3),55<a)for(h(this._hash,e),a=0;a<16;a+=1)e[a]=0;r=(r=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),n=parseInt(r[2],16),i=parseInt(r[1],16)||0,e[14]=n,e[15]=i,h(this._hash,e)},v.hash=function(e,t){return v.hashBinary(a(e),t)},v.hashBinary=function(e,t){var r=g(i(e));return t?b(r):r},(v.ArrayBuffer=function(){this.reset()}).prototype.append=function(e){var t,r=function(e,t,r){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e)),n.set(new Uint8Array(t),e.byteLength),r?n:n.buffer}(this._buff.buffer,e,!0),n=r.length;for(this._length+=e.byteLength,t=64;t<=n;t+=64)h(this._hash,m(r.subarray(t-64,t)));return this._buff=t-64<n?new Uint8Array(r.buffer.slice(t-64)):new Uint8Array(0),this},v.ArrayBuffer.prototype.end=function(e){var t,r,n=this._buff,i=n.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)a[t>>2]|=n[t]<<(t%4<<3);return this._finish(a,i),r=g(this._hash),e&&(r=b(r)),this.reset(),r},v.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},v.ArrayBuffer.prototype.getState=function(){var e=v.prototype.getState.call(this);return e.buff=function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}(e.buff),e},v.ArrayBuffer.prototype.setState=function(e){return e.buff=function(e,t){var r,n=e.length,i=new ArrayBuffer(n),a=new Uint8Array(i);for(r=0;r<n;r+=1)a[r]=e.charCodeAt(r);return t?a:i}(e.buff,!0),v.prototype.setState.call(this,e)},v.ArrayBuffer.prototype.destroy=v.prototype.destroy,v.ArrayBuffer.prototype._finish=v.prototype._finish,v.ArrayBuffer.hash=function(e,t){var r=g(function(e){var t,r,n,i,a,o,s=e.length,u=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=s;t+=64)h(u,m(e.subarray(t-64,t)));for(e=t-64<s?e.subarray(t-64):new Uint8Array(0),r=e.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<r;t+=1)n[t>>2]|=e[t]<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),55<t)for(h(u,n),t=0;t<16;t+=1)n[t]=0;return i=(i=8*s).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(i[2],16),o=parseInt(i[1],16)||0,n[14]=a,n[15]=o,h(u,n),u}(new Uint8Array(e)));return t?b(r):r},v}()}),t={},a=".dui-upload-list__item",l="dui-upload-list",r=".dui-upload-dragger",f=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,r){t&&o(e.prototype,t),r&&o(e,r)}(e,[{key:"md5",value:function(r,t,n){var i=this;this.aborted=!1;var a=this.progress=0,o=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,s=2097152,u=Math.ceil(r.size/s),l=new p.ArrayBuffer,f=new FileReader;function c(){var e=a*s,t=e+s>=r.size?r.size:e+s;f.readAsArrayBuffer(o.call(r,e,t))}c(),f.onloadend=function(e){l.append(e.target.result),a++,i.progress=a/u,n&&"function"==typeof n&&n(i.progress),i.aborted?t("aborted"):a<u?c():t(null,l.end())}}},{key:"abort",value:function(){this.aborted=!0}}]),e}());function n(e){var t=new i(e);return function(){var e=this;return{config:e.config,upload:function(){e.upload.call(e)},pause:function(){e.pause.call(e)},cancel:function(){e.cancel.call(e)}}}.call(t)}function i(e){this.config=u.extend(!0,{el:"",server:"",accept:"images",showFileList:!0,listType:"text",fileList:[],autoUpload:!0,exts:"",headers:{},pick:"",pickText:"上传图片",name:"file",data:{},testChunks:!1,drag:!1,onSuccess:"",onError:"",onBefore:"",onComplete:"",onProgress:"",multiple:!1,chunkSize:1048576,maxFiles:void 0,resize:!1},t,e);this.render()}return i.prototype.render=function(){var e=this,r=e.config,t=e.el=u(r.el);if(!t[0])throw new Error("upload initialization failed，Because there is no container.");if(!e.innerHtml||t.html(e.innerHtml),e.innerHtml=t.html(),e.listItemTpl=function(e,t){return['<li class="dui-upload-list__item is-'+t+'">',"picture"==r.listType?'<img src="'+e.url+'" alt="'+e.name+'" class="dui-upload-list__item-thumbnail">':"",'<a class="dui-upload-list__item-name"><i class="dui-icon-document"></i>'+e.name+"</a>",'<label class="dui-upload-list__item-status-label"><i class="dui-icon-upload-success dui-icon-'+("text"==r.listType?"circle-":"")+'check"></i></label>','<i class="dui-icon-close"></i>',"</li>"].join("")},e.uploadDom=u('<div class="dui-upload dui-upload-'+r.listType+'"></div>'),e.pick=t.find(r.pick)[0]?t.find(r.pick)[0]:t.children()[0]?t.children()[0]:u('<button type="button" class="dui-button dui-button--primary dui-button--small">'+r.pickText+"</button>"),t.prepend(e.uploadDom),e.uploadDom.append(e.pick),r.showFileList){var n=['<ul class="dui-upload-list dui-upload-list--'+r.listType+'"></div>'].join(""),i=e.showListDom=t.find(l)[0]?t.find(l):u(n);if(t.append(i),r.fileList&&0<r.fileList.length){var a=[];u.each(r.fileList,function(e,t){var r=listItemTpl(t,"success");a.push(r)}),i.append(a.join(""))}}var o={target:r.server,query:u.extend(!0,{form:"dui.upload"},r.data),simultaneousUploads:r.simultaneousUploads||3,fileParameterName:r.name,chunkSize:r.chunkSize,headers:r.headers,maxFiles:r.maxFiles,testChunks:r.testChunks};e.r=new s(o),e.setCallBack()},i.prototype.setCallBack=function(){var s=this,i=s.config,n=s.r,e=(s.uploadDom,s.pick),t=s.el.find(r)[0]?s.el.find(r)[0]:s.el[0];n.assignBrowse(e),!1!==i.drag&&n.assignDrop(t),n.on("fileAdded",function(a){var o={name:a.fileName,url:""};i.showFileList&&function(e,t){var r,n="",i=!1,a=new FileReader;a.onerror=function(e){n="转换错误",i=!0},a.onload=function(e){i=!(n=""),r=e.target.result},a.readAsDataURL(e);var o=setInterval(function(){!0===i&&(clearInterval(o),t(n,r))},10)}(a.file,function(e,t){o.url=e?"":t;var r=u(s.listItemTpl(o,"is-ready"));r[0].uploadId=a.uniqueIdentifier,s.showListDom.append(r);var n=['<div class="dui-progress dui-progress--line" style="display:none">','<div class="dui-progress-bar">','<div class="dui-progress-bar__outer" style="height: 2px;">','<div class="dui-progress-bar__inner" style="width: 0%;">',"</div>","</div>","</div>",'<div class="dui-progress__text" style="font-size: 12.8px;">0%</div>',"</div>"].join(""),i=r[0].progress=u(n);r.append(i)}),f.md5(a.file,function(e,t){if(n.opts.query.fileMd5=t,a.file.fileMd5=t,i.autoUpload){var r=!0;i.onBefore&&"function"==typeof i.onBefore&&(r=i.onBefore.call(null,a)),!1!==r&&n.upload()}})}),n.on("fileProgress",function(r){var n=r.progress();i.showFileList&&s.showListDom.find(a).each(function(e,t){t.uploadId==r.uniqueIdentifier&&(t.progress.css("display",""),u(t).find(".dui-progress-bar__inner").css("width",100*n+"%"),u(t).find(".dui-progress__text").text(100*n+"%"))}),i.onProgress&&"function"==typeof i.onProgress&&i.onProgress.call(null,r,n)}),n.on("fileSuccess",function(r,e){i.showFileList&&s.showListDom.find(a).each(function(e,t){t.uploadId==r.uniqueIdentifier&&(u(t).removeClass("is-uploading").addClass("is-success"),t.progress.remove())}),i.onSuccess&&"function"==typeof i.onSuccess&&i.onSuccess.call(null,r,JSON.parse(e))}),n.on("fileError",function(r,e){i.showFileList&&s.showListDom.find(a).each(function(e,t){t.uploadId==r.uniqueIdentifier&&t.remove()}),i.onError&&"function"==typeof i.onError&&i.onError.call(null,r,e)})},i.prototype.upload=function(){this.r.upload()},i.prototype.pause=function(){this.r.pause()},i.prototype.cancel=function(){this.r.cancel()},n.config=function(e){return t=u.extend(!0,t,e),this},n.render=function(e){return n(e)},n}(r)}(e={exports:{}},e.exports),e.exports});